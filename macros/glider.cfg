[event]
name=start
[set_menu_item]
id=fly
description="Fly here."

[show_if]
[have_location]
x,y=$x1,$y1
terrain={TLIST}
[/have_location]
[not]
[have_unit]
x,y=$x1,$y1
side=$side_number
[/have_unit]
[/not]
[have_unit]
side=$side_number
type=HT_Soldier
x=$selected_unit.x
y=$selected_unit.y
[not]
[filter_wml]
moves=0
[/filter_wml]
[/not]
[/have_unit]
[/show_if]
[command]

[store_gold]
side=$side_number
variable=gold
[/store_gold]
[message]
speaker=narrator
message="Are you sure? You have $gold gold."
[option]
message="Yes. Fly here for 50 gold."
[show_if]
[variable]
name=gold
greater_than_equal_to=50
[/variable]
[/show_if]
[command]
[gold]
side=$side_number
amount=-50
[/gold]

[move_unit_fake]
type=Drake Glider
side=$side_number
x=1,$selected_unit.x
y=1,$selected_unit.y
[/move_unit_fake]
[store_unit]
[filter]
side=$side_number
x,y=$selected_unit.x,$selected_unit.y
type=HT_Soldier
[/filter]
variable=selected_unit
kill=yes
[/store_unit]
[move_unit_fake]
type=Drake Glider
side=$side_number
x=$selected_unit.x,$x1
y=$selected_unit.y,$y1
[/move_unit_fake]
[if]
[have_unit]
x,y=$x1,$y1
[/have_unit]
[then]
[store_unit]
[filter]
x,y=$x1,$y1
[/filter]
variable=killed
[/store_unit]
[kill]
x,y=$x1,$y1
animate=yes
[/kill]
[if]
[not]
[have_unit]
side=$killed.side
canrecruit=no
[/have_unit]
[/not]
[then]
[message]
speaker=narrator
message="Player $killed.side is eliminated by Player $selected_unit.side|!"
[/message]
[store_gold]
side=$killed.side
variable=gold
[/store_gold]
[gold]
side=$selected_unit.side
amount=$gold
[/gold]
[gold]
side=$killed.side
amount=-$gold
[/gold]
[sound]
name=gold.ogg
[/sound]
[unstore_unit]
variable=selected_unit
text=$gold
red,green,blue=255,255,0
[/unstore_unit]
[kill]
side=$killed.side
canrecruit=yes
[/kill]
[store_locations]
variable=allterrain
[/store_locations]
{FOREACH allterrain j}
[if]
[variable]
name=$allterrain[$j].x|_$allterrain[$j].y|.controller
equals=$killed.side
[/variable]
[then]
{CAPTURE_HEX $selected_unit.side $allterrain[$j].x| $allterrain[$j].y|}
[/then]
[/if]
{NEXT j}
[/then]
[/if]
{CLEAR_VARIABLE allterrain}
[/then]
[/if]
{VARIABLE selected_unit.x $x1}
{VARIABLE selected_unit.y $y1}
{VARIABLE selected_unit.moves 0}
[unstore_unit]
variable=selected_unit
[/unstore_unit]
{CAPTURE_HEX $selected_unit.side $x1| $y1|}
{CLEAR_VARIABLE selected_unit}
[/command]
[/option]

[option]
message="No."
[command]
[/command]
[/option]
[/message]

[/command]
[/set_menu_item]
[/event]